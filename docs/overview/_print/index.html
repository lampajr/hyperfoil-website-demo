<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://lampajr.github.io/hyperfoil-website-demo/docs/overview/><link rel=alternate type=application/rss+xml href=https://lampajr.github.io/hyperfoil-website-demo/docs/overview/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/hyperfoil-website-demo/favicons/favicon.ico><link rel=apple-touch-icon href=/hyperfoil-website-demo/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/hyperfoil-website-demo/favicons/android-192x192.png sizes=192x192><title>Overview | Hyperfoil</title><meta name=description content="Generic overview on the Hyperfoil tool"><meta property="og:title" content="Overview"><meta property="og:description" content="Generic overview on the Hyperfoil tool"><meta property="og:type" content="website"><meta property="og:url" content="https://lampajr.github.io/hyperfoil-website-demo/docs/overview/"><meta itemprop=name content="Overview"><meta itemprop=description content="Generic overview on the Hyperfoil tool"><meta name=twitter:card content="summary"><meta name=twitter:title content="Overview"><meta name=twitter:description content="Generic overview on the Hyperfoil tool"><link rel=preload href=/hyperfoil-website-demo/scss/main.min.d0336840d8c0ef45658fa040135fe63f4426d79b707feb7cf795756dd7001fc7.css as=style><link href=/hyperfoil-website-demo/scss/main.min.d0336840d8c0ef45658fa040135fe63f4426d79b707feb7cf795756dd7001fc7.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/hyperfoil-website-demo/><span class="navbar-brand__logo navbar-logo"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="200pt" height="200pt" viewBox="0 0 200 200"><g transform="translate(0.000000,200.000000) scale(0.100000,-0.100000)" fill="#000" stroke="none"><path d="M692 1873c-28-5-45-42-109-231-82-246-95-317-1e2-572-4-171-1-254 11-345 25-186 20-177 107-198 103-26 359-28 480-4 167 33 349 105 349 138 0 63-115 359-332 854-80 182-148 338-151 348-6 15-20 17-119 16-62-1-123-4-136-6zm228-1e2c0-106 20-593 26-640 5-43 6-43 46-43h40l-6 48c-8 69-29 512-24 517 4 4 289-634 338-760 33-83 80-222 80-235 0-19-298-120-354-120-13 0-16 13-16 68 0 37-3 97-7 135l-6 67h-38c-26 0-37-4-34-12 2-7 6-70 10-140l6-127-47-7c-49-7-250 10-320 27l-41 11-12 68c-38 230-38 515-1 705 21 107 97 352 138 447 23 52 27 53 155 56l67 2v-67z"/><path d="M1460 580c-31-4-103-24-160-44-219-78-416-102-609-72-57 9-106 14-108 13-10-11 294-67 363-67 31 0 32-1 38-57 4-32 10-66 12-76 5-14-17-28-113-74l-118-57 48-15 49-15 196 99c169 84 193 99 172 106-40 12-79 10-108-5-15-7-37-17-50-21-22-6-23-5-20 52l3 58 120 2c66 2 147 5 181 8l61 6 52 81c28 44 51 81 49 82s-28-1-58-4z"/></g></svg></span><span class=navbar-brand__name>Hyperfoil</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class="nav-link active" href=/hyperfoil-website-demo/docs/><span>Docs</span></a></li><li class=nav-item><a class=nav-link href=/hyperfoil-website-demo/blog/><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/hyperfoil-website-demo/download/><span>Download</span></a></li><li class=nav-item><a class=nav-link href=/hyperfoil-website-demo/community/><span>Community</span></a></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/hyperfoil-website-demo/offline-search-index.f1ac41eb8b05a1883fb9903f8e9886ca.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/hyperfoil-website-demo/docs/overview/>Return to the regular view of this page</a>.</p></div><h1 class=title>Overview</h1><div class=lead>Generic overview on the Hyperfoil tool</div><ul><li>1: <a href=#pg-8eeb8711c9212b6d71c2599b66bb4de8>Concepts</a></li><li>2: <a href=#pg-b0f8e4ee3509d229b406a0b0bb933ca4>FAQ</a></li></ul><div class=content><p>There’s plenty of web benchmark tools around and it might be hard to pick one, and investing time into not-established tools is risky. Hyperfoil was not created for the pure joy of coding but as a solution to set of problems which could not be solved all by single other existing tool.</p><h2 id=free-software>Free software<a class=td-heading-self-link href=#free-software aria-label="Heading self-link"></a></h2><p>Free software allows you to take your benchmark and publish it for everyone to verify. With proprietary licenses that wouldn&rsquo;t be so easy.</p><p>Hyperfoil is licensed under <a href=http://www.apache.org/licenses/LICENSE-2.0>Apache License 2.0</a>.</p><h2 id=distribution>Distribution<a class=td-heading-self-link href=#distribution aria-label="Heading self-link"></a></h2><p>Generating load with single node stops scaling at certain point and you need to orchestrate the benchmark across a cluster of nodes. Simple command-line tools usually ignore this completely (you&rsquo;re supposed to start them, gather and merge the data in a bash scripts). Other tools use open-core model with the clustering part being a paid/proprietary option. There are frameworks that have clustering built in as well.</p><p>Hyperfoil uses leader-follower model with Vert.x Event bus as the clustering middleware. While running from single VM is possible (and <a href=/docs/getting-started/quickstart1/>quite easy</a>) as well, the design is distributed by default.</p><h2 id=accuracy>Accuracy<a class=td-heading-self-link href=#accuracy aria-label="Heading self-link"></a></h2><p>The point of web benchmark is usually finding out what happens when your system is accessed by thousands of concurrent users - each doing a page load every few seconds. However many traditional load drivers simplify the scenario to few dozen of virtual users (VUs) that execute one request after another or with very short delays in between - this is referred to as the Closed System Model (as the set of VUs is finite). This discrepancy leads to problem known as <a href=https://www.azul.com/files/HowNotToMeasureLatency_LLSummit_NYC_12Nov2013.pdf>coordinated omission</a> and results in significantly skewed latency results and pathological conditions (queues overflow&mldr;) not being triggered.</p><p>Hyperfoil embraces Open System Model by default - virtual users are completely independent until it runs out of resources, recording that situation in consequence. Hyperfoil runs a state-machine for each VU and all requests are executed asynchronously.</p><h2 id=versatility>Versatility<a class=td-heading-self-link href=#versatility aria-label="Heading self-link"></a></h2><p>While you can design your benchmark to just hit single endpoint (URL) with desired rate this is likely not what the users would be doing. Randomizing some parts of the query or looping through a list of endpoint might be better but the resulting scenario might be still too simplified.</p><p>Hyperfoil introduces a DSL expressed in YAML with which you can sketch the scenario in a fine detail, including timing, concurrent requests, processing responses and so forth. We&rsquo;re not trying to invent a new programming language, though, so if the DSL gets too complex you can <a href=/docs/getting-started/quickstart8>write the logic</a> in Java or any other JVM language.</p><hr><p>If you&rsquo;re eager to try out Hyperfoil go to the <a href=/docs/getting-started/quickstart1>first quickstart</a>. Otherwise let&rsquo;s have a deeper look into the <a href=/docs/overview/concepts>terms and concepts</a>.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8eeb8711c9212b6d71c2599b66bb4de8>1 - Concepts</h1><div class=lead>Hyperfoil key terms and concepts</div><p>This document explains some core terms used throughout the documentation.</p><h2 id=controller-and-agents>Controller and agents<a class=td-heading-self-link href=#controller-and-agents aria-label="Heading self-link"></a></h2><p>While it is possible to run benchmarks directly from CLI, in its nature Hyperfoil is a distributed tool with leader-follower architecture. <strong>Controller</strong> has the leader role; this is a <a href=https://vertx.io>Vert.x</a>-based server with REST API. When a benchmark is started controller deploys agents (according to the benchmark definition), pushes the benchmark definition to these agents and orchestrates benchmark phases. <strong>Agents</strong> execute the benchmark, periodically sending statistics to the controller. This way the controller can combine and evaluate statistics from all agents on the fly. When the benchmark is completed all agents terminate.</p><p>All communication between the controller and agents happens over Vert.x eventbus - therefore it is independent on the deployment type.</p><h2 id=phases>Phases<a class=td-heading-self-link href=#phases aria-label="Heading self-link"></a></h2><p>Conceptually the benchmark consists of several phases. Phases can run independently of each other;
these simulate certain load executed by a group of users (e.g. visitors vs. admins). Within one phase all users execute the same scenario (e.g. logging into the system, selling all their stock and then logging off).</p><p>Phases are also using for scaling the load during the benchmark; when looking for maximum throughput you schedule several iterations of given phase, gradually increasing the number of users that run the scenario.</p><p>A phase can be in one of these states:</p><ul><li>not running (scheduled)</li><li>running</li><li>finished: users won&rsquo;t start new scenarios but we&rsquo;ll let already-started users complete the scenario</li><li>terminated: all users are done, all stats are collected and no further requests will be made</li></ul><p>The state of phase on every agent is managed by Controller; this is also the finest grained unit of work it understands (controller has no information about state of each user).</p><h2 id=sessions>Sessions<a class=td-heading-self-link href=#sessions aria-label="Heading self-link"></a></h2><p>The state of each user&rsquo;s scenario is saved in the session; sometimes we speak about (re)starting sessions instead of starting new users. Hyperfoil tries to keep allocations during benchmark as low as possible and therefore it pre-allocates all memory for the scenario execution ahead. This is why all resources the benchmark uses are capped - it needs to know the sizes of pools.</p><p>It is also necessary to know how many sessions we should preallocate - maximum concurrency of the system. If this threshold is exceeded Hyperfoil allocates further session as needed, but this is not the optimal mode of operation. It means that either you&rsquo;ve underestimated the resources need or you&rsquo;ve put a load on the system that it can&rsquo;t handle anymore, requests are not being completed and scenarios are not finished - which means that session objects cannot be recycled for reuse by next user.</p><h2 id=scenario>Scenario<a class=td-heading-self-link href=#scenario aria-label="Heading self-link"></a></h2><p>Scenario consists of one or more <strong>sequences</strong> that are composed of <strong>steps</strong>. Steps are similar to statements in programming language and sequences are an equivalent of blocks of code.</p><p>While most of the time the scenario will consist of sequential operations as the user is not multi-tasking, the browser (or other system you&rsquo;re simulating) actually executes some operations in parallel - e.g. during page load it loads images concurrently. Therefore at any time the session contains one or more active <strong>sequence instances</strong>; when all sequence instances are done, the session has finished and can be recycled for a new user. Most of the time the scenario will start with only one active instance and as it progresses, it might create instances of other sequences (e.g after evaluating a condition it creates a sequence instance according to the branching logic).</p></div><div class=td-content style=page-break-before:always><h1 id=pg-b0f8e4ee3509d229b406a0b0bb933ca4>2 - FAQ</h1><div class=lead>Frequently Asked Questions</div><h2 id=why-is-hyperfoil-written-in-java>Why is Hyperfoil written in Java?<a class=td-heading-self-link href=#why-is-hyperfoil-written-in-java aria-label="Heading self-link"></a></h2><p>People are often concerned about JVM performance or predictability. While nowadays JVM is very good in the sense of throughput, dealing with jitter can be challenging. We are Java engineers, though, and we believe that these issues can be mitigated with a right design. That&rsquo;s why we try to be very careful on the execution hot-path.</p><p>We could achieve even better properties with C/C++, but the development effectivity would suffer. We could be succesful in Go, but we&rsquo;re not as intimate with its internals. Other languages and frameworks would pose its own challenges. So far, the choice of Java was not found to be a limiting factor.</p><h2 id=why-are-you-inventing-your-own-yaml-based-dsl-instead-of-using-javasciptlua>Why are you inventing your own YAML-based DSL instead of using Javascipt/Lua/&mldr;?<a class=td-heading-self-link href=#why-are-you-inventing-your-own-yaml-based-dsl-instead-of-using-javasciptlua aria-label="Heading self-link"></a></h2><p>While some people might be more comfortable with describing their complex scenarios in a familiar language, running a script execution engine would have impact on performance and could put us out of control. We are not trying to invent a new language, written in YAML structure. Instead we propose a set of components common to many scenarios that could be recombined as it suits you. If you ever feel that the YAML is becoming cumbersome, try to move your complex benchmark logic to Java code and use it that way, instead.</p><h2 id=i-just-want-to-know-what-is-the-maximum-throughput>I just want to know what is the maximum throughput!<a class=td-heading-self-link href=#i-just-want-to-know-what-is-the-maximum-throughput aria-label="Heading self-link"></a></h2><p>Maximum throughput is a single number which makes comparison very easy. Was my code change for better or worse? However finding the sweet spot is not as simple as throwing in few hundred concurrent threads running one request after another and taking the readings. With too high concurrency you can get worse results due to contention and longer queues, so you need to try different concurrency levels anyway.</p><p>There&rsquo;s nothing wrong with this type of test as long as you know what you&rsquo;re doing, and that the <a href=https://www.slideshare.net/slideshow/how-not-to-measure-latency-60111840/60111840>response latencies might be far off reality</a>. It&rsquo;s actually very good test when you look only for regressions - and Hyperfoil supports that, too.</p><h2 id=hyperfoil-is-so-hard-to-set-up-ill-just-use->Hyperfoil is so hard to set up, I&rsquo;ll just use &mldr;<a class=td-heading-self-link href=#hyperfoil-is-so-hard-to-set-up-ill-just-use- aria-label="Heading self-link"></a></h2><p>Some tools can be run from the shell, with everything set just through options and arguments. That is quite handy for a quick test - and if the tool is sufficient for the job, use it. Or you can try runnning the same through Hyperfoil - e.g. for <code>wrk</code>/<code>wrk2</code> we offer a facade (CLI command <code>wrk</code> or <code>bin/wrk.sh</code>) that creates a benchmark with the same behaviour but you also get all the detailed results as from any other run - see <a href=/docs/migration/wrk/>the migration guide</a>. Once that your requirements outgrow what&rsquo;s possible in these simple tools, you can embrace the full power of benchmark composition.</p><h2 id=what-does-that-exceeded-session-limit-error-mean>What does that &lsquo;Exceeded session limit&rsquo; error mean?<a class=td-heading-self-link href=#what-does-that-exceeded-session-limit-error-mean aria-label="Heading self-link"></a></h2><p>With <a href=/docs/user-guide/benchmark/phase/>open-model phase types</a> (constantRate, increasingRate, decreasingRate) the concurrency should not be limited. However as Hyperfoil tries not to allocate any memory during the benchmark we need to reserve space ahead for all sessions that could run concurrently - we call this the session limit. By default this limit is equal to number of users per second (assuming that the scenario won&rsquo;t take more than 1 second).</p><p>When you get the &lsquo;Exceeded session limit&rsquo; error this means that some of the requests took a long time (or you have delays as part of the scenario) and Hyperfoil ran out of session pool. In that case you can change the limit using <code>maxSessions</code> property on the phase to the expected maximum concurrency. E.g. if you expect that the scenario will take 3 seconds and you&rsquo;re running at <code>usersPerSec: 100</code> you should set <code>maxSessions: 300</code> (or rather more to give it a buffer for unexpected jitter).</p><p>If increasing the limit doesn&rsquo;t help it usually means that the load at the tested system is too high and the responses are not arriving as fast as you fire the requests. In that case you should lower the load.</p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub Discussions" aria-label="GitHub Discussions"><a target=_blank rel=noopener href=https://github.com/Hyperfoil/Hyperofil/discussions aria-label="GitHub Discussions"><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Twitter aria-label=Twitter><a target=_blank rel=noopener href=https://x.com/Hyperfoil aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/Hyperfoil/Hyperofil aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Zulip aria-label=Zulip><a target=_blank rel=noopener href=https://hyperfoil.zulipchat.com/ aria-label=Zulip><i class="fab fa-z"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub Issues" aria-label="GitHub Issues"><a target=_blank rel=noopener href=https://github.com/Hyperfoil/Hyperofil/issues aria-label="GitHub Issues"><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2017&ndash;2024
<span class=td-footer__authors>Hyperfoil | <a href=https://www.apache.org/licenses/LICENSE-2.0>Apache License 2.0</a> |</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span><span class=ms-2><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></span></div></div></div></footer></div><script src=/hyperfoil-website-demo/js/main.min.53f3e04e8d693751b0d08317a1dfec9508d2a99f2a3d232d929e075cd6f20865.js integrity="sha256-U/PgTo1pN1Gw0IMXod/slQjSqZ8qPSMtkp4HXNbyCGU=" crossorigin=anonymous></script>
<script defer src=/hyperfoil-website-demo/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script>
<script src=/hyperfoil-website-demo/js/tabpane-persist.js></script></body></html>